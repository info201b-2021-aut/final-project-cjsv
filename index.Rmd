---
title: "Biodiversity in National Parks"
author: "Cindy Te, Jessica Zhang, Shirley Yao, Victoria Limwanich"
date: "11/19/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
source("scripts/summary_info.R")
source("scripts/aggregate_table.R")
source("scripts/chart_1.R")
source("scripts/chart_2.R")
source("scripts/chart_3.R")
```

## Introduction
The purpose and importance of this project is to learn more about the trends of biodiversity. As humans are quickly exceeding one of the nine planetary boundaries, biosphere integrity (especially genetic biodiversity), it is urgent for us find information, analyze it, and understand the trends of biodiversity to develop solutions to prevent biodiversity from further reducing and to help mitigate its negative impacts.

## Summary Information

In a study containing `r get_summary_info(read.csv("scripts/data/national_parks_biodiversity/species.csv"))["total_species"]` species across 
`r get_summary_info(read.csv("scripts/data/national_parks_biodiversity/species.csv"))["total_parks"]` national parks, 
there are `r get_summary_info(read.csv("scripts/data/national_parks_biodiversity/species.csv"))["total_categories"]` different categories of species
that contain a total of `r get_summary_info(read.csv("scripts/data/national_parks_biodiversity/species.csv"))["total_species_type"]` different types of species.
Of these species, there are a total of `r get_summary_info(read.csv("scripts/data/national_parks_biodiversity/species.csv"))["total_rare"]` rare species, 
`r get_summary_info(read.csv("scripts/data/national_parks_biodiversity/species.csv"))["total_endangered"]` of which are endangered species.

## Aggregate Table

The table groups each national parks' observations together to summarize the total number of species in each park, and then calculate the percentage of species that are of concern, threatened, or endangered.
The table shows that Petrified Forest National Park has the highest percentage (9.26%) of species that are of concern, threatened, or endangered, while Gates Of The Arctic National Park and Preserve has the lowest percentage (1.55%) of species that are of concern, threatened, or endangered. This gives insight on which national parks are at a higher risk of biodiversity loss.

```{r echo = FALSE}
kable(aggregate_table(read.csv("scripts/data/national_parks_biodiversity/species.csv")), col.names = c(
  "Park",
  "Total of Species",
  "Percent of Species of Concern, Threatened, or Endangered"
))
```

## Chart 1
```{r echo = FALSE}
chart_1
```
<br> This bar chart shows percentage of native species in different national parks. It offers a quick overview of the percentage of native species by state. 
The chart was created by grouping the parks by state and finding the number of species that are native to the state. That number was then divided by the total number of species found in the state and multiplied by 100 to find the percentage. The states are listed in alphabetical order. Right away, we can see that some states like Arizona, Utah, and New Mexico have percentages above 75. Meanwhile, Nevada and Oregon have a native species percentage below 50%. As invasive species are detrimental ecosystems, this gives us some insight into state of national parks. 

## Chart 2
```{r echo = FALSE}
chart_2
```
<br> This chart gives a visualization of the level of biodiversity in different national parks across the United States. It helps give a comparison and ranking of the state of biodiversity across different states/regions. 
This chart was made using the number of unique orders (Carnivora, Rodentia, etc.) in each reported National Park, and then grouping them together by state. From this chart, we can see that the distribution of biodiversity is varied and doesn't have much pattern. The leading state by a large margin, California, has a reported 400 unique orders, and the reported state with the least biodiversity, New Mexico, has 72 unique orders in its national parks. This gives us insight into the amount and state of national parks in the different regions, including the amount of reported orders. 

## Chart 3
```{r echo = FALSE}
chart_3
```
<br> The scatter plot visualizes the number of endangered species in every national park in the U.S., in which we can see that Hawaii Volcanoes National Park has the highest number of endangered species, whereas most of the other national parks' endangered species number range between 0-10. By creating the plot with clear visualization, we are motivated to ask questions that deepens our understanding of conservation and biodiversity, such as why are certain national parks have more endangered species than others? What are the implications in terms of maintaining biodiversity in the context of places relatively free from human intervention such as national parks?
